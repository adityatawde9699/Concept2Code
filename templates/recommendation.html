{% extends "base.html" %}
{% block title %}AI Recommendation - ParkWise{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8 col-xl-7">
        <a href="/slots" class="btn btn-sm btn-outline-secondary mb-3">Back to Slots</a>
        <h1 class="page-title mb-2">AI Recommendation</h1>
        <p class="text-secondary mb-4">Best slot based on zone priority and availability.</p>

        {% if best_slot %}
        {% set heat = 'heat-high' if score >= 130 else 'heat-mid' if score >= 90 else 'heat-low' %}
        <div class="card border-0 shadow-sm slot-card {{ heat }} mb-3">
            <div class="card-body p-4">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <div>
                        <p class="small text-success fw-semibold mb-1">Best Match</p>
                        <h2 class="h4 mb-1">Slot {{ best_slot.slot_number }}</h2>
                        <p class="text-secondary mb-0">Zone {{ best_slot.zone }}</p>
                    </div>
                    <div class="text-end">
                        <p class="small text-secondary mb-1">Score</p>
                        <p class="h3 text-primary mb-0">{{ score }}</p>
                    </div>
                </div>

                <div class="row g-2 mb-3 small">
                    <div class="col-4"><div class="p-2 rounded border bg-light text-center"><p class="mb-1 text-secondary">Zone</p><strong>{{ best_slot.zone }}</strong></div></div>
                    <div class="col-4"><div class="p-2 rounded border bg-light text-center"><p class="mb-1 text-secondary">Rate/hr</p><strong>â‚¹{{ best_slot.price_per_hour }}</strong></div></div>
                    <div class="col-4"><div class="p-2 rounded border bg-light text-center"><p class="mb-1 text-secondary">Status</p>{% if best_slot.is_occupied %}<span class="badge status-pill status-occupied">Occupied</span>{% else %}<span class="badge status-pill status-available">Free</span>{% endif %}</div></div>
                </div>

                {% if not best_slot.is_occupied %}
                <a href="/booking/{{ best_slot.id }}" class="btn btn-success w-100">Book This Slot</a>
                {% else %}
                <div class="alert alert-danger mb-0" role="alert">This slot is occupied right now. Please browse other available slots.</div>
                {% endif %}
            </div>
        </div>

        <div class="card border-0 shadow-sm">
            <div class="card-body p-4">
                <h2 class="h6 mb-3">How Scores Are Calculated</h2>
                <ul class="small text-secondary mb-0 ps-3">
                    <li>Zone A: +100 points</li>
                    <li>Zone B: +70 points</li>
                    <li>Zone C: +40 points</li>
                    <li>Available now: +50 points</li>
                    <li>Freeing soon: +30 points</li>
                </ul>
            </div>
        </div>
        {% else %}
        <div class="empty-state">
            <p class="mb-3">No slots available to recommend right now.</p>
            <a href="/slots" class="btn btn-primary">Browse All Slots</a>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
