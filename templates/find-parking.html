{% extends "base.html" %}

{% block title %}Find Parking - ParkWise{% endblock %}

{% block content %}
<div class="page-container">
    <h1 class="page-title">Find Your Parking</h1>
    
    {% if top_recommendations %}
    <section class="recommendations">
        <h2 class="section-title">Top Recommendations For You</h2>
        <div class="slots-grid">
            {% for slot in top_recommendations %}
            <div class="slot-card {% if slot.is_occupied %}occupied{% else %}available{% endif %}">
                <div class="slot-header">
                    <h3 class="slot-number">{{ slot.slot_number }}</h3>
                    <div class="slot-badge">Zone {{ slot.zone }}</div>
                </div>
                
                <div class="slot-details">
                    {% if not slot.is_occupied %}
                        <div class="status-badge available">Available</div>
                    {% else %}
                        <div class="status-badge occupied">Occupied</div>
                    {% endif %}
                    
                    <div class="price-row">
                        <span class="label">Per Hour</span>
                        <span class="price">₹{{ slot.price_per_hour }}</span>
                    </div>
                </div>
                
                {% if not slot.is_occupied %}
                <a href="/booking/{{ slot.id }}" class="btn btn-primary">Book Now</a>
                {% else %}
                <button class="btn btn-disabled" disabled>Not Available</button>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    <section class="all-slots">
        <h2 class="section-title">Browse by Zone</h2>
        
        {% for zone in zones %}
        <div class="zone-section">
            <h3 class="zone-title">Zone {{ zone }}</h3>
            <div class="slots-list">
                {% set zone_slots = [] %}
                {% for slot in all_available %}
                    {% if slot.zone == zone %}
                        {% if zone_slots.append(slot) %}{% endif %}
                    {% endif %}
                {% endfor %}
                
                {% for slot in zone_slots %}
                <div class="slot-item">
                    <div class="slot-left">
                        <h4>{{ slot.slot_number }}</h4>
                        <p class="slot-price">₹{{ slot.price_per_hour }}/hr</p>
                    </div>
                    {% if not slot.is_occupied %}
                    <a href="/booking/{{ slot.id }}" class="btn-small">Book</a>
                    {% else %}
                    <span class="status-occupied">Occupied</span>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </section>

    {% if not all_available %}
    <div class="empty-state">
        <p class="empty-message">No available slots at the moment. Please check back soon!</p>
    </div>
    {% endif %}
</div>
{% endblock %}
